<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <div id="profile"></div>
  <button id="logoutBtn">Hivoaka</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAzcnb-eswHt_pDi7tCvcIBzlzejCprJfE",
      authDomain: "mitalky.firebaseapp.com",
      projectId: "mitalky",
      storageBucket: "mitalky.appspot.com",
      messagingSenderId: "753557195623",
      appId: "1:753557195623:web:abc3b37eca5d67c9157dc2"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    auth.onAuthStateChanged(user => {
      if (!user) return (window.location.href = "nextpage.html");
      const uid = user.uid;

      db.collection("users").doc(uid).get().then(doc => {
        if (!doc.exists) {
          document.getElementById("profile").innerHTML = `
            <h3>Mamorona profil</h3>
            <input id="name" placeholder="Anarana" />
            <select id="genre">
              <option value="">Genre</option>
              <option value="garÃ§on">GarÃ§on</option>
              <option value="fille">Fille</option>
              <option value="autre">Autre</option>
            </select>
            <button onclick="saveProfile()">Enregistrer</button>
          `;
        } else {
          const data = doc.data();
          document.getElementById("profile").innerHTML = `
            <h2>${data.name}</h2>
            <p>Genre: ${data.genre || "-"}</p>
            <p>ID: ${data.id}</p>
            <p>Email: ${data.email || user.phoneNumber}</p>
            <a href="chat.html?uid=${uid}">Mankanesa amin'ny chat</a>
          `;
        }
      });
    });

    function saveProfile() {
      const uid = auth.currentUser.uid;
      const name = document.getElementById("name").value.trim();
      const genre = document.getElementById("genre").value;
      const id = Math.floor(100000 + Math.random() * 900000);
      const email = auth.currentUser.email || auth.currentUser.phoneNumber;

      db.collection("users").doc(uid).set({ name, genre, id, email }).then(() => location.reload());
    }

    document.getElementById("logoutBtn").onclick = () => auth.signOut().then(() => location.href = "nextpage.html");
  </script>
</body>
</html>
```

---
ðŸ“„ **chat.html** â€“ Fifampiresahana (Text-only)
---

```html
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Chat</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <h2>Chat</h2>
  <input id="targetId" placeholder="ID olona hafa" />
  <button onclick="loadChat()">Ampidiro olona</button>

  <div id="chatBox" style="border:1px solid #ccc; padding:10px; margin-top:10px; height:200px; overflow:auto"></div>
  <input id="msg" placeholder="Lazao hafatra" />
  <button onclick="sendMsg()">Alefa</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAzcnb-eswHt_pDi7tCvcIBzlzejCprJfE",
      authDomain: "mitalky.firebaseapp.com",
      projectId: "mitalky",
      storageBucket: "mitalky.appspot.com",
      messagingSenderId: "753557195623",
      appId: "1:753557195623:web:abc3b37eca5d67c9157dc2"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    let myUid, myId, otherUid;

    auth.onAuthStateChanged(user => {
      if (!user) return (window.location.href = "nextpage.html");
      myUid = user.uid;
      db.collection("users").doc(myUid).get().then(doc => {
        myId = doc.data().id;
      });
    });

    function loadChat() {
      const targetId = document.getElementById("targetId").value;
      db.collection("users").where("id", "==", parseInt(targetId)).get().then(snapshot => {
        if (!snapshot.empty) {
          otherUid = snapshot.docs[0].id;
          listenToMessages();
        } else {
          alert("Tsy hita ilay olona");
        }
      });
    }

    function listenToMessages() {
      const chatId = [myUid, otherUid].sort().join("_");
      db.collection("chats").doc(chatId).collection("messages").orderBy("time")
        .onSnapshot(snapshot => {
          const box = document.getElementById("chatBox");
          box.innerHTML = "";
          snapshot.forEach(doc => {
            const msg = doc.data();
            box.innerHTML += `<p><strong>${msg.from === myUid ? "Izaho" : "Izy"}:</strong> ${msg.text}</p>`;
          });
          box.scrollTop = box.scrollHeight;
        });
    }

    function sendMsg() {
      const text = document.getElementById("msg").value.trim();
      if (!text || !otherUid) return;
      const chatId = [myUid, otherUid].sort().join("_");
      db.collection("chats").doc(chatId).collection("messages").add({
        from: myUid,
        text,
        time: firebase.firestore.FieldValue.serverTimestamp()
      });
      document.getElementById("msg").value = "";
    }
  </script>
</body>
</html>
